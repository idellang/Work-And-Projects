---
title: "Nestle Trips"
author: "Me"
date: "1/29/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(RPostgreSQL)
library(getPass)
library(lubridate)
```

Establish Connection
```{r}

pgdrv <- dbDriver(drvName = "PostgreSQL")
postgrescon <-DBI::dbConnect(pgdrv,
                    dbname="WTI",
                    host="localhost", port=5432,
                    user = 'postgres',
                    password = getPass("Enter Password:"))
```


Process data
```{r}
data = read_csv('GPS-DATA.csv')

data = data %>%
      filter(str_detect(alert_msgs, 'Invalid', negate = TRUE))

data = data %>%
      mutate(datestamp = mdy_hms(datestamp)) %>%
      select(-alert_msgs)
```

Upload data to postgresql
```{r}
dbWriteTable(postgrescon, "nestle_staging", data, row.names=FALSE, append=TRUE)
```
















